--SET SCHEMA TO GROUP
ALTER SESSION SET CURRENT_SCHEMA = DT2283GROUP_T; 

-- Drop Tables
DROP TABLE Sale CASCADE CONSTRAINTS PURGE;

DROP TABLE Repair_on_site CASCADE CONSTRAINTS PURGE;

DROP TABLE Repair_off_site CASCADE CONSTRAINTS PURGE;

DROP TABLE Fault CASCADE CONSTRAINTS PURGE;

DROP TABLE Appliance CASCADE CONSTRAINTS PURGE;

DROP TABLE Customer CASCADE CONSTRAINTS PURGE;

DROP TABLE Service_center CASCADE CONSTRAINTS PURGE;

DROP TABLE Manufacturer CASCADE CONSTRAINTS PURGE;

-- Create table manufacturer
CREATE TABLE Manufacturer
(
	Manufactor_ID        NUMBER NOT NULL ,
	Manufactor_Name      VARCHAR2(30) NULL ,
	Manufactor_Address   VARCHAR2(30) NULL ,
	Manufactor_Phone     NUMBER(10) NULL ,
CONSTRAINT  Manufacturer_PK PRIMARY KEY (Manufactor_ID)
);

-- Create table service_enter
CREATE TABLE Service_center
(
	Centre_ID            NUMBER NOT NULL ,
	Manufactor_ID        NUMBER(7) NULL ,
	Centre_Name          VARCHAR2(30) NULL ,
	Centre_Address       VARCHAR2(30) NULL ,
CONSTRAINT  Service_center_PK PRIMARY KEY (Centre_ID),
CONSTRAINT service_center_manufactuer_FK FOREIGN KEY (Manufactor_ID) REFERENCES Manufacturer (Manufactor_ID)
);

-- Create table customer
CREATE TABLE Customer
(
	Customer_ID          NUMBER NOT NULL ,
	Customer_Name        VARCHAR2(30) NULL ,
	Customer_Address     VARCHAR2(30) NULL ,
	Customer_Phone       NUMBER(10) NULL ,
CONSTRAINT  Customer_PK PRIMARY KEY (Customer_ID)
);

-- Create table appliance
CREATE TABLE Appliance
(
	Serial_number        NUMBER NOT NULL ,
	Manufactor_ID        NUMBER NULL ,
	Guarantee            NUMBER NULL ,
	Appliance_Price      NUMBER(7,2) NULL ,
	Appliance_Name       VARCHAR2(30) NULL ,
	Stock                NUMBER NULL ,
CONSTRAINT  Appliance_PK PRIMARY KEY (Serial_number),
CONSTRAINT appliance_manufacturer_FK FOREIGN KEY (Manufactor_ID) REFERENCES Manufacturer (Manufactor_ID)
);

-- Create table fault
CREATE TABLE Fault
(
	Fault_ID             NUMBER NOT NULL ,
	Customer_ID          NUMBER NULL ,
	Serial_number        NUMBER NOT NULL ,
	Cust_Description     VARCHAR2(30) NULL ,
	Date_Submitted       DATE NULL ,
	Condition            VARCHAR2(30) NULL ,
CONSTRAINT  Fault_PK PRIMARY KEY (Fault_ID,Serial_number),
CONSTRAINT fault_customer FOREIGN KEY (Customer_ID) REFERENCES Customer (Customer_ID),
CONSTRAINT fault_appliance_FK FOREIGN KEY (Serial_number) REFERENCES Appliance (Serial_number)
);

-- Create table repair off site
CREATE TABLE Repair_off_site
(
	Centre_ID            NUMBER NULL ,
	Fault_ID             NUMBER NOT NULL ,
	Serial_number        NUMBER NOT NULL ,
	Date_of_Repair       DATE NULL ,
	Parts_Replaced       VARCHAR2(30) NULL ,
CONSTRAINT  Repair_off_site_PK PRIMARY KEY (Fault_ID,Serial_number),
CONSTRAINT Repair_service_center_FK FOREIGN KEY (Centre_ID) REFERENCES Service_center (Centre_ID),
CONSTRAINT Repair_off_fault_FK FOREIGN KEY (Fault_ID, Serial_number) REFERENCES Fault (Fault_ID, Serial_number)
);

-- Create table repair on site
CREATE TABLE Repair_on_site
(
	Fault_ID             NUMBER NOT NULL ,
	Serial_number        NUMBER NOT NULL ,
	Date_of_Repair       DATE NULL ,
	Part_Replaced        VARCHAR2(30) NULL ,
	Duration             NUMBER NULL ,
CONSTRAINT  Repair_on_site_PK PRIMARY KEY (Fault_ID,Serial_number),
CONSTRAINT Repair_on_Fault_FK FOREIGN KEY (Fault_ID, Serial_number) REFERENCES Fault (Fault_ID, Serial_number)
);

-- Create table sale
CREATE TABLE Sale
(
	Sale_ID              NUMBER NOT NULL ,
	Customer_ID          NUMBER NULL ,
	Serial_number        NUMBER(7) NULL ,
	Date_of_Sale         DATE NULL ,
CONSTRAINT  Sale_PK PRIMARY KEY (Sale_ID),
CONSTRAINT sale_customer_FK FOREIGN KEY (Customer_ID) REFERENCES Customer (Customer_ID),
CONSTRAINT sale_appliance_FK FOREIGN KEY (Serial_number) REFERENCES Appliance (Serial_number)
);
commit;
 
-- Insert Into Customer
INSERT INTO CUSTOMER (CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_PHONE)
VALUES (001,'Mason Cole',0981018877);

INSERT INTO CUSTOMER (CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_PHONE)
VALUES (002,'Chris Garneau',8886541122);

INSERT INTO CUSTOMER (CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_PHONE)
VALUES (003,'Jennifer Watson',894015975);

INSERT INTO CUSTOMER (CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_PHONE)
VALUES (004,'James Bourne',0861018877);

INSERT INTO CUSTOMER (CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_PHONE)
VALUES (005,'Mary Sands',018787654);


-- Insert in manufacturer
INSERT INTO manufacturer (MANUFACTOR_ID,MANUFACTOR_NAME, MANUFACTOR_PHONE)
VALUES (001,'Nintendo',018789898);

INSERT INTO manufacturer (MANUFACTOR_ID,MANUFACTOR_NAME, MANUFACTOR_PHONE)
VALUES (002,'Sony',013435566);

INSERT INTO manufacturer (MANUFACTOR_ID,MANUFACTOR_NAME, MANUFACTOR_PHONE)
VALUES (003,'Samsung',013432211);

INSERT INTO manufacturer (MANUFACTOR_ID,MANUFACTOR_NAME,MANUFACTOR_PHONE)
VALUES (004,'Breville',018989898);

INSERT INTO manufacturer (MANUFACTOR_ID,MANUFACTOR_NAME,MANUFACTOR_PHONE)
VALUES (005,'Microsoft',016768854);


-- insert into appliance
INSERT INTO appliance (SERIAL_NUMBER,MANUFACTOR_ID,GUARANTEE,APPLIANCE_PRICE,APPLIANCE_NAME,STOCK)
VALUES (001,001,12,150.00,'Wii Console',30);

INSERT INTO appliance (SERIAL_NUMBER,MANUFACTOR_ID,GUARANTEE,APPLIANCE_PRICE,APPLIANCE_NAME,STOCK)
VALUES (002,002,36,1200.00,'TV',20);

INSERT INTO appliance (SERIAL_NUMBER,MANUFACTOR_ID,GUARANTEE,APPLIANCE_PRICE,APPLIANCE_NAME,STOCK)
VALUES (003,003,18,115.00,'Earphones',50);

INSERT INTO appliance (SERIAL_NUMBER,MANUFACTOR_ID,GUARANTEE,APPLIANCE_PRICE,APPLIANCE_NAME,STOCK)
VALUES (004,004,24,46.00,'Juicer',15);

INSERT INTO appliance (SERIAL_NUMBER,MANUFACTOR_ID,GUARANTEE,APPLIANCE_PRICE,APPLIANCE_NAME,STOCK)
VALUES (005,005,12,399.00,'Xbox',17);


-- insert into fault
INSERT INTO FAULT (CUSTOMER_ID,SERIAL_NUMBER,CUST_DESCRIPTION,DATE_SUBMITTED,CONDITION)
VALUES (001,001,'Broken plug','17-JUN-2013','Plug fluse blown');

INSERT INTO FAULT (CUSTOMER_ID,SERIAL_NUMBER,CUST_DESCRIPTION,DATE_SUBMITTED,CONDITION)
VALUES (002,002,'No signal','15-MAY-2013','Receiver damaged');

INSERT INTO FAULT (CUSTOMER_ID,SERIAL_NUMBER,CUST_DESCRIPTION,DATE_SUBMITTED,CONDITION)
VALUES (003,003,'Frayed wire','02-FEB-2013','Wire stripped');

INSERT INTO FAULT (CUSTOMER_ID,SERIAL_NUMBER,CUST_DESCRIPTION,DATE_SUBMITTED,CONDITION)
VALUES (004,004,'Not spinning','10-APR-2013','Dead motor');

INSERT INTO FAULT (CUSTOMER_ID,SERIAL_NUMBER,CUST_DESCRIPTION,DATE_SUBMITTED,CONDITION)
VALUES (005,005,'No connection','21-JAN-2013','Port damaged');


-- insert into sale
INSERT INTO SALE (SALE_ID,CUSTOMER_ID,SERIAL_NUMBER,DATE_OF_SALE)
VALUES (01, 001, 001, '19-JUN-2011');

INSERT INTO SALE (SALE_ID,CUSTOMER_ID,SERIAL_NUMBER,DATE_OF_SALE)
VALUES (02, 002, 002, '25-JAN-2011');

INSERT INTO SALE (SALE_ID,CUSTOMER_ID,SERIAL_NUMBER,DATE_OF_SALE)
VALUES (03, 003, 003, '12-FEB-2011');

INSERT INTO SALE (SALE_ID,CUSTOMER_ID,SERIAL_NUMBER,DATE_OF_SALE)
VALUES (04, 004, 004, '22-FEB-2011');

INSERT INTO SALE (SALE_ID,CUSTOMER_ID,SERIAL_NUMBER,DATE_OF_SALE)
VALUES (05, 005, 005, '01-MAR-2011');


-- Repair on site
INSERT INTO REPAIR_ON_SITE (PART_ID,SERIAL_NUMBER,DATE_OF_REPAIR,PART_REPLACED,DURATION,DATE_SUBMITTED)
VALUES (1, 001, '5-MAY-13', 'Fuse', 4, '21-JUN-2011');

INSERT INTO REPAIR_ON_SITE (PART_ID,SERIAL_NUMBER,DATE_OF_REPAIR,PART_REPLACED,DURATION,DATE_SUBMITTED)
VALUES (2, 002, '30-MAY-13', 'Receiver', 2,'19-FEB-2011');

INSERT INTO REPAIR_ON_SITE (PART_ID,SERIAL_NUMBER,DATE_OF_REPAIR,PART_REPLACED,DURATION,DATE_SUBMITTED)
VALUES (3, 003, '12-JAN-13', 'Wire', 4,'05-MAR-2011');


-- Service Centre
INSERT INTO service_center (CENTRE_ID,MANUFACTOR_ID,CENTRE_NAME,CENTRE_ADDRESS)
VALUES (2, 1, 'O,Connell Repair' , 'Sandyford');

INSERT INTO service_center (CENTRE_ID,MANUFACTOR_ID,CENTRE_NAME,CENTRE_ADDRESS)
VALUES (4, 2, 'Pro Repair', 'Navan');

INSERT INTO service_center (CENTRE_ID,MANUFACTOR_ID,CENTRE_NAME,CENTRE_ADDRESS)
VALUES (6, 3, 'Drogheda Repair', 'Drogheda');

INSERT INTO service_center (CENTRE_ID,MANUFACTOR_ID,CENTRE_NAME,CENTRE_ADDRESS)
VALUES (8, 4, 'Dan Fay Repair', 'Adare');

INSERT INTO service_center (CENTRE_ID,MANUFACTOR_ID,CENTRE_NAME,CENTRE_ADDRESS)
VALUES (10, 5, 'Dundrum Repair Centre', 'Dundrum');


-- Repair off site
INSERT INTO repair_off_site (PART_ID,SERIAL_NUMBER,CENTRE_ID,DATE_OF_REPAIR, PARTS_REPLACED,DATE_SUBMITTED)
VALUES (4, 004, 2,'26-JUL-2015', 'Motor','17-APR-2011');

INSERT INTO repair_off_site (PART_ID,SERIAL_NUMBER,CENTRE_ID,DATE_OF_REPAIR, PARTS_REPLACED,DATE_SUBMITTED)
VALUES (5, 005, 4,'02-OCT-2015', 'LAN port','02-FEB-2011');

--GRANTS
GRANT ALL ON Sale TO okane, jlee;
GRANT ALL ON Repair_on_site TO okane, ogrogan;
GRANT ALL ON Repair_off_site TO okane, ogrogan;
GRANT ALL ON Fault TO okane, ogrogan;
GRANT ALL ON Appliance TO okane, jlee, ogrogan;
GRANT ALL ON Customer TO okane, jlee;
GRANT ALL ON Service_center TO okane, ogrogan;
GRANT ALL ON Manufacturer TO okane;

commit;